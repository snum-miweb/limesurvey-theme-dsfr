{#
/**
 * Array Multi-Flexi - Answer Cell - DSFR Theme
 * Cell with dropdown or text input for numeric values
 *
 * @var $dataTitle           Label text for this cell
 * @var $dataCode            Column code
 * @var $ld                  Column code (alternative)
 * @var $answertypeclass     Answer type CSS class
 * @var $extraclass          Extra CSS classes
 * @var $myfname2            Full field name
 * @var $basename            Base name for aria labels
 * @var $error               Whether cell has error
 * @var $value               Current value
 * @var $inputboxlayout      Whether to use text input (true) or dropdown (false)
 * @var $minvalue            Minimum value (for dropdown)
 * @var $maxvalue            Maximum value (for dropdown)
 * @var $stepvalue           Step value (for dropdown)
 * @var $sSeparator          Decimal separator
 * @var $kpclass             Keypad class
 * @var $maxlength           Max length attribute
 * @var $inputsize           Input size attribute
 */
#}

<!-- answer_td - select-item requis pour em_javascript.js quand dropdown -->
<td class="answer_cell_{{ ld }} answer-item select-item {{ answertypeclass }} {{ extraclass }}{% if error %} has-error{% endif %}" title="{{ processString(dataTitle)|striptags }}">
    {# Hidden field for expression manager javascript #}
    {{ C.Html.hiddenField("java"~myfname2, value, ({
        'id' : "java"~myfname2,
        'disabled' : true,
    })) }}

    <label for="answer{{ myfname2 }}" class="fr-sr-only">
        {{ processString(dataTitle) }}
    </label>

    {% if inputboxlayout == false %}
        <!-- Dropdown Layout -->
        <div class="fr-select-group{% if error %} fr-select-group--error{% endif %}">
            <select
                class="fr-select{% if error %} fr-select--error{% endif %}"
                name="{{ myfname2 }}"
                id="answer{{ myfname2 }}"
                aria-labelledby="answertext{{ basename }}_{{ dataCode }}"
            >
                <option value="">{{ gT('...') }}</option>
                {% for i in range(minvalue, maxvalue, stepvalue) %}
                    {% set selected = value is not empty and value|t == i|t ? 'selected' : '' %}
                    <option value="{{ i|replace({'.' : sSeparator}) }}" {{ selected }}>
                        {{ i|replace({'.': sSeparator}) }}
                    </option>
                {% endfor %}
            </select>
        </div>
    {% elseif inputboxlayout == true %}
        <!-- Text Input Layout -->
        <div class="fr-input-group{% if error %} fr-input-group--error{% endif %}">
            {{ C.Html.textField(myfname2, value, ({
                'id' : "answer"~myfname2,
                'aria-labelledby' : "answertext" ~ basename ~ "_" ~ dataCode,
                'class' : "fr-input "~kpclass~(error ? " fr-input--error" : ""),
                'title' : gT('Only numbers may be entered in this field.'),
                'size' : (inputsize ? inputsize : null),
                'maxlength' : (maxlength ? maxlength : null),
                'data-number' : 1,
            })) }}
        </div>
    {% endif %}
</td>
<!-- end of answer_td -->
